<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Kindle Dashboard</title>
  <style type="text/css">
body {
  position: relative;
  margin: 0 auto;
  padding: 0;
  max-width: 800px;
}
a {
  color: #000;
  text-decoration: none;
}
img {
  max-width: 100%;
}
#time {
  margin: 0;
  padding: 0 10px;
  border-bottom: 1px solid #000;
  font-size: 6em;
}
#time span {
  float: right;
  margin: 10px 0;
  font-size: 0.4em;
  text-align: right;
}
p {
  margin: 5px 0;
}

ul {
  list-style: none;
}

body {
  font: 1rem/1.3 "Roboto", sans-serif;
  background: var(--bg_main);
  color: var(--text_dark);
  padding: 70px;
}

.container {
  width: 100%;
  max-width: 1200px;
  margin: 0 auto;
  padding: 0 15px;
}


/* SECTION #1
‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì */
.top-banner {
  color: var(--text_light);
}

.heading {
  font-weight: bold;
  font-size: 4rem;
  letter-spacing: 0.02em;
  padding: 0 0 30px 0;
}

.top-banner form {
  position: relative;
  display: flex;
  align-items: center;
}

.top-banner form input {
  font-size: 2rem;
  height: 40px;
  padding: 5px 5px 10px;
  border-bottom: 1px solid;
}

.top-banner form input::placeholder {
  color: currentColor;
}

.top-banner form button {
  font-size: 1rem;
  font-weight: bold;
  letter-spacing: 0.1em;
  padding: 15px 20px;
  margin-left: 15px;
  border-radius: 5px;
  background: var(--red);
  transition: background 0.3s ease-in-out;
}

.top-banner form button:hover {
  background: var(--darkred);
}

.top-banner form .msg {
  position: absolute;
  bottom: -40px;
  left: 0;
  max-width: 450px;
  min-height: 40px;
}


/* SECTION #2
‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì */
.ajax-section {
  margin: 10px 0 20px;
}

.ajax-section .cities {
  display: grid;
  grid-gap: 32px 20px;
  grid-template-columns: repeat(2, 1fr);
}

.ajax-section .city {
  position: relative;
  padding: 40px 10%;
  border-radius: 20px;
  background: var(--text_light);
  color: var(--text_med);
}

.ajax-section .city::after {
  content: '';
  width: 90%;
  height: 50px;
  position: absolute;
  bottom: -12px;
  left: 5%;
  z-index: -1;
  opacity: 0.3;
  border-radius: 20px;
  background: var(--text_light);
}

.ajax-section figcaption {
  margin-top: 10px;
  text-transform: uppercase;
  letter-spacing: 0.05em;
}

.ajax-section .city-temp {
  font-size: 5rem;
  font-weight: bold;
  margin-top: 10px;
  color: var(--text_dark);
}

.ajax-section .city sup {
  font-size: 0.5em;
}

.ajax-section .city-name sup {
  padding: 0.2em 0.6em;
  border-radius: 30px;
  color: var(--text_light);
  background: var(--orange);
}

.ajax-section .city-icon {
  margin-top: 10px;
  width: 100px;
  height: 100px;
}


/* FOOTER
‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì */
.page-footer {
  text-align: right;
  font-size: 1rem;
  color: var(--text_light);
  margin-top: 40px;
}

.page-footer span {
  color: var(--red);
}
.rules {
  display: grid;
  grid-template-columns: 1fr
}
.rules > * {
  margin-top: 10px;
  margin-bottom: 10px;
  font-size: 20px;
  text-align: center;
}
.timeel {
  font-weight: bold;
  font-size: 42px;
}
.countup {
  text-align: center;
  margin-bottom: 50px;
}
  </style>
</head>
<body>
  <h1 id="time"></h1>
  <section class="ajax-section">
    <div class="container">
      <ul class="cities"></ul>
    </div>
  </section>
  <hr>
  <div class="count">
    <div class="rules">
      <h3>Do podpisania notariusza:</h3>
      <div class="countup" id="countup1">
        <span class="timeel days">00</span>
        <span class="timeel timeRefDays">d</span>
        <span class="timeel hours">00</span>
        <span class="timeel timeRefHours">g</span>
        <span class="timeel minutes">00</span>
        <span class="timeel timeRefMinutes">m</span>
        <span class="timeel seconds">00</span>
        <span class="timeel timeRefSeconds">s</span>
      </div>
    </div>
    <div class="rules">
      <h3>Do architekta:</h3>
      <div class="countup" id="countup2">
        <span class="timeel days">00</span>
        <span class="timeel timeRefDays">d</span>
        <span class="timeel hours">00</span>
        <span class="timeel timeRefHours">g</span>
        <span class="timeel minutes">00</span>
        <span class="timeel timeRefMinutes">m</span>
        <span class="timeel seconds">00</span>
        <span class="timeel timeRefSeconds">s</span>
      </div>
    </div>
  </div>

  <script type="text/javascript">
    // Clock
    var airlyHours = [8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23]; // when to fetch air quality
    var meteoHours = [6, 12, 18]; // when to fetch forecast/news
    var offset = 5; // offset in minutes
    var days = ['niedziela', 'poniedzia≈Çek', 'wtorek', '≈õroda', 'czwartek', 'piƒÖtek', 'sobota'];
    var months = ['stycznia', 'lutego', 'marca', 'kwietnia', 'maja', 'czerwca', 'lipca', 'sierpnia', 'wrze≈õnia', 'pa≈∫dziernika', 'listopada', 'grudnia'];
    function tick() {
      var today = new Date();
      var mo = months[today.getMonth()];
      var d = today.getDate();
      var dw = days[today.getDay()];
      var h = today.getHours();
      var m = today.getMinutes();
      document.getElementById('time').innerHTML = h + ':' + (m < 10 ? '0' : '') + m + ' <span>' + dw + '<br>' + d + '. ' + mo + '</span>';
    }
    tick();
    setInterval(tick, 60*1000);

  </script>
  <script>
    const apiKey = "4d8fb5b93d4af21d66a2948710284366";
    const form = document.querySelector(".top-banner form");
    const input = document.querySelector(".top-banner input");
    const list = document.querySelector(".ajax-section .cities");


    getWeather = (cityName) => {
      let inputVal = cityName;
      //check if there's already a city
      const listItems = list.querySelectorAll(".ajax-section .city");
      const listItemsArray = Array.from(listItems);

      if (listItemsArray.length > 0) {
        const filteredArray = listItemsArray.filter(el => {
          let content = "";
          //athens,gr
          if (inputVal.includes(",")) {
            //athens,grrrrrr->invalid country code, so we keep only the first part of inputVal
            if (inputVal.split(",")[1].length > 2) {
              inputVal = inputVal.split(",")[0];
              content = el
                      .querySelector(".city-name span")
                      .textContent.toLowerCase();
            } else {
              content = el.querySelector(".city-name").dataset.name.toLowerCase();
            }
          } else {
            //athens
            content = el.querySelector(".city-name span").textContent.toLowerCase();
          }
          return content == inputVal.toLowerCase();
        });

        if (filteredArray.length > 0) {
          msg.textContent = `You already know the weather for ${
                  filteredArray[0].querySelector(".city-name span").textContent
          } ...otherwise be more specific by providing the country code as well üòâ`;
        }
      }

      //ajax here
      const url = `https://api.openweathermap.org/data/2.5/weather?q=${inputVal}&appid=${apiKey}&units=metric`;

      fetch(url)
              .then(response => response.json())
              .then(data => {
                const { main, name, sys, weather } = data;
                const icon = `https://s3-us-west-2.amazonaws.com/s.cdpn.io/162656/${
                        weather[0]["icon"]
                }.svg`;

                const li = document.createElement("li");
                li.classList.add("city");
                const markup = `
        <h2 class="city-name" data-name="${name},${sys.country}">
          <span>${inputVal === 'Krak√≥w' ? 'Aktualny domek:' : 'Przysz≈Çy domek:'}</span> <br />
          <span>${name}</span>
          <sup>${sys.country}</sup>
        </h2>
        <div class="city-temp">${Math.round(main.temp)}<sup>¬∞C</sup></div>
        <figure>
          <img class="city-icon" src="${icon}" alt="${
                        weather[0]["description"]
                }">
          <figcaption>${weather[0]["description"]}</figcaption>
        </figure>
      `;
                li.innerHTML = markup;
                list.appendChild(li);
              })
              .catch(() => {
                msg.textContent = "Please search for a valid city üò©";
              });

    }

    getWeather('Krak√≥w');
    getWeather('Gilowice');

  </script>
  <script>
    // count
     countUpFromTime = (countFrom, id) =>  {
      countFrom = new Date(countFrom).getTime();
      var now = new Date(),
              countFrom = new Date(countFrom),
              timeDifference = (now - countFrom);

      var secondsInADay = 60 * 60 * 1000 * 24,
              secondsInAHour = 60 * 60 * 1000;

      days = Math.floor(timeDifference / (secondsInADay) * 1);
      years = Math.floor(days / 365);
      if (years > 1){ days = days - (years * 365) }
      hours = Math.floor((timeDifference % (secondsInADay)) / (secondsInAHour) * 1);
      mins = Math.floor(((timeDifference % (secondsInADay)) % (secondsInAHour)) / (60 * 1000) * 1);
      secs = Math.floor((((timeDifference % (secondsInADay)) % (secondsInAHour)) % (60 * 1000)) / 1000 * 1);
      var idEl = document.getElementById(id);
      idEl.getElementsByClassName('days')[0].innerHTML = (days * -1);
      idEl.getElementsByClassName('hours')[0].innerHTML = hours * -1;
      idEl.getElementsByClassName('minutes')[0].innerHTML = mins * -1;
      idEl.getElementsByClassName('seconds')[0].innerHTML = secs * -1;

      // clearTimeout(countUpFromTime.interval);
      // countUpFromTime.interval = setTimeout(function(){ countUpFromTime(countFrom, id); }, 1000);
    }
    setInterval(() => countUpFromTime("May 17, 2021 11:00:00", 'countup1'), 1000);
    setInterval(() =>  countUpFromTime("Jun 18, 2021 09:30:00", 'countup2'), 1000);
    // countUpFromTime("May 17, 2021 11:00:00", 'countup1')

  </script>
</body>
</html>
